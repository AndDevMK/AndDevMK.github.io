<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Java必备基础之反射 - AndDevMK&#39;s android blog site</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="AndDevMK" /><meta name="description" content="注：本文代码基于JDK 11 一、Class类 每个已加载的类在内存都有一份类信息，每个对象都有指向它所属类信息的引用，Java中类信息对应的类就是java.lang.Class，所有类的根父类Object有一个方法，可以获取对象的Class对象，请看如下代码： 1 public final native Class&amp;lt;?&amp;gt; getClass(); Class是一" /><meta name="keywords" content="Android, Java, Kotlin, C&#43;&#43;, C, Flutter, Dart, NDK" />


<meta name="baidu-site-verification" content="codeva-wQ7uOo4V09" />
<meta name="google-site-verification" content="yHzWB9BxTR74LiaUhuL5ncr89fnDYXiplTaPY565zqo" />


<meta name="generator" content="Hugo 0.111.3 with theme even" />


<link rel="canonical" href="https://anddevmk.github.io/post/java%E5%BF%85%E5%A4%87%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%8F%8D%E5%B0%84/" />
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">



<link href="/sass/main.min.c11aaf02bef1025d6b0813ba5e1a8a8551aee15fa8f2bcea906d41b20bdf5c69.css" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">
<link rel="stylesheet" href="/css/codecopy.css">


<meta property="og:title" content="Java必备基础之反射" />
<meta property="og:description" content="注：本文代码基于JDK 11 一、Class类 每个已加载的类在内存都有一份类信息，每个对象都有指向它所属类信息的引用，Java中类信息对应的类就是java.lang.Class，所有类的根父类Object有一个方法，可以获取对象的Class对象，请看如下代码： 1 public final native Class&lt;?&gt; getClass(); Class是一" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://anddevmk.github.io/post/java%E5%BF%85%E5%A4%87%E5%9F%BA%E7%A1%80%E4%B9%8B%E5%8F%8D%E5%B0%84/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2023-12-20T08:00:00+08:00" />
<meta property="article:modified_time" content="2023-12-20T08:00:00+08:00" />
<meta itemprop="name" content="Java必备基础之反射">
<meta itemprop="description" content="注：本文代码基于JDK 11 一、Class类 每个已加载的类在内存都有一份类信息，每个对象都有指向它所属类信息的引用，Java中类信息对应的类就是java.lang.Class，所有类的根父类Object有一个方法，可以获取对象的Class对象，请看如下代码： 1 public final native Class&lt;?&gt; getClass(); Class是一"><meta itemprop="datePublished" content="2023-12-20T08:00:00+08:00" />
<meta itemprop="dateModified" content="2023-12-20T08:00:00+08:00" />
<meta itemprop="wordCount" content="4910">
<meta itemprop="keywords" content="" /><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Java必备基础之反射"/>
<meta name="twitter:description" content="注：本文代码基于JDK 11 一、Class类 每个已加载的类在内存都有一份类信息，每个对象都有指向它所属类信息的引用，Java中类信息对应的类就是java.lang.Class，所有类的根父类Object有一个方法，可以获取对象的Class对象，请看如下代码： 1 public final native Class&lt;?&gt; getClass(); Class是一"/>

<!--[if lte IE 9]>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/classlist/1.1.20170427/classList.min.js"></script>
<![endif]-->

<!--[if lt IE 9]>
  <script src="https://cdn.jsdelivr.net/npm/html5shiv@3.7.3/dist/html5shiv.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/respond.js@1.4.2/dest/respond.min.js"></script>
<![endif]-->


</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">AndDevMK</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">首页</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">分类</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">归档</li>
      </a><a href="/about/">
        <li class="mobile-menu-item">关于</li>
      </a>

    
    <li class="mobile-menu-item-search">
      <div id="mobile_open_search" class="mobile_open_search">
        搜索
      </div>
    </li>

    
    <li class="mobile-menu-item-dark-mode">
      <div id="mobile_dark_mode_toggle" class="mobile_light_mode">
       
      </div>
    </li>
  </ul>

  


</nav>

  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">AndDevMK</a>
</div>





<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">首页</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">分类</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">归档</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/about/">关于</a>
      </li>
    
    <div id="open_search" class="open_search">
      搜索
    </div>

    
    <div id="dark_mode_toggle" class="light_mode">

    </div>
  
  </ul>
</nav>

    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">Java必备基础之反射</h1>

      <div class="post-meta">
        <span class="post-time"> 2023-12-20 </span>
        <div class="post-category">
            <a href="/categories/java/"> Java </a>
            </div>
          <span class="more-meta"> 约 4910 字 </span>
          <span class="more-meta"> 预计阅读 10 分钟 </span>
        
      </div>
    </header>

    <div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
    <nav id="TableOfContents">
  <ul>
    <li><a href="#一class类">一、<em>Class</em>类</a>
      <ul>
        <li><a href="#11名称信息">1.1、名称信息</a></li>
        <li><a href="#12字段信息">1.2、字段信息</a></li>
        <li><a href="#13方法信息">1.3、方法信息</a></li>
        <li><a href="#14创建对象和构造方法">1.4、创建对象和构造方法</a></li>
        <li><a href="#15类型检查和转换">1.5、类型检查和转换</a></li>
        <li><a href="#16class的类型信息">1.6、<em>Class</em>的类型信息</a></li>
        <li><a href="#17类的声明信息">1.7、类的声明信息</a></li>
        <li><a href="#18类的加载">1.8、类的加载</a></li>
        <li><a href="#19反射与数组">1.9、反射与数组</a></li>
        <li><a href="#110反射与枚举">1.10、反射与枚举</a></li>
      </ul>
    </li>
    <li><a href="#二反射与泛型">二、反射与泛型</a></li>
  </ul>
</nav>
  </div>
</div>
    <div class="post-content">
      <blockquote>
<p><em>注：本文代码基于JDK 11</em></p>
</blockquote>
<h1 id="一class类">一、<em>Class</em>类</h1>
<p>每个已加载的类在内存都有一份类信息，每个对象都有指向它所属类信息的引用，<em>Java</em>中类信息对应的类就是<em>java.lang.Class</em>，所有类的根父类<em>Object</em>有一个方法，可以获取对象的<em>Class</em>对象，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">final</span> <span class="kd">native</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">getClass</span><span class="o">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Class</em>是一个泛型类，有一个类型参数，<em>getClass()<em>并不知道具体的类型，所以返回</em>Class<?></em>。</p>
<p>获取<em>Class</em>对象不一定需要实例对象，如果在写程序时就知道类名，可以使用<code>&lt;类名&gt;.class</code>获取<em>Class</em>对象，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;</span><span class="n">Date</span><span class="o">&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">Date</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>接口也有<em>Class</em>对象，且这种方式对于接口也是适用的，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;</span><span class="n">Comparable</span><span class="o">&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">Comparable</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>基本类型没有<em>getClass</em>方法，但也都有对应的<em>Class</em>对象，类型参数为对应的包装类型，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;</span><span class="n">Integer</span><span class="o">&gt;</span> <span class="n">intCls</span> <span class="o">=</span> <span class="kt">int</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;</span><span class="n">Byte</span><span class="o">&gt;</span> <span class="n">byteCls</span> <span class="o">=</span> <span class="kt">byte</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;</span><span class="n">Character</span><span class="o">&gt;</span> <span class="n">charCls</span> <span class="o">=</span> <span class="kt">char</span><span class="o">.</span><span class="na">class</span><span class="o">;</span> 
</span></span><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;</span><span class="n">Double</span><span class="o">&gt;</span> <span class="n">doubleCls</span> <span class="o">=</span> <span class="kt">double</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>void</em>作为特殊的返回类型，也有对应的<em>Class</em>，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;</span><span class="n">Void</span><span class="o">&gt;</span> <span class="n">voidCls</span> <span class="o">=</span> <span class="kt">void</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>对于数组，每种类型都有对应数组类型的<em>Class</em>对象，每个维度都有一个，即一维数组有一个，二维数组有一个不同的类型，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">String</span><span class="o">[]</span> <span class="n">strArr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span><span class="o">[][]</span> <span class="n">twoDimArr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="mi">3</span><span class="o">][</span><span class="mi">2</span><span class="o">];</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span><span class="o">[]</span> <span class="n">oneDimArr</span> <span class="o">=</span> <span class="k">new</span> <span class="kt">int</span><span class="o">[</span><span class="mi">10</span><span class="o">];</span>
</span></span><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">String</span><span class="o">[]&gt;</span> <span class="n">strArrCls</span> <span class="o">=</span> <span class="n">strArr</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="kt">int</span><span class="o">[][]&gt;</span> <span class="n">twoDimArrCls</span> <span class="o">=</span> <span class="n">twoDimArr</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span> 
</span></span><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="kt">int</span><span class="o">[]&gt;</span> <span class="n">oneDimArrCls</span> <span class="o">=</span> <span class="n">oneDimArr</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>枚举类型也有对应的<em>Class</em>，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">enum</span> <span class="n">Size</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">SMALL</span><span class="o">,</span> <span class="n">MEDIUM</span><span class="o">,</span> <span class="n">BIG</span> 
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;</span><span class="n">Size</span><span class="o">&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">Size</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Class</em>有一个静态方法<em>forName</em>，可以根据类名直接加载<em>Class</em>，获取<em>Class</em>对象，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">&#34;java.util.HashMap&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cls</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">ClassNotFoundException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>有了<em>Class</em>对象后，我们就可以获取到关于类型的很多信息，并基于这些信息采取一些行动。</p>
<h2 id="11名称信息">1.1、名称信息</h2>
<p><em>Class</em>有如下方法，可以获取与名称有关的信息，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 返回Java内部使用的真正名称
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回的名称不带包信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">String</span> <span class="nf">getSimpleName</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回的名称更为友好
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">String</span> <span class="nf">getCanonicalName</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回的包信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Package</span> <span class="nf">getPackage</span><span class="o">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>数组类型的<em>getName</em>返回值，它使用前缀<code>[</code>表示数组，有几个<code>[</code>表示是几维数组；数组的类型用一个字符表示，<code>I</code>表示<em>int</em>, <code>L</code>表示类或接口，其它类型与字符的对应关系为：<code>boolean(Z)</code>、<code>byte(B)</code>、<code>char(C)</code>、<code>double(D)</code>、<code>float(F)</code>、<code>long(J)</code>、<code>short(S)</code>。对于引用类型的数组，注意最后有一个分号<code>;</code>。不同<em>Class</em>对象的各种名称方法的返回值如下图所示。</p>
<img title="" src="/img/java/Java必备基础之反射/名称信息.png" alt="" width="535" />
<h2 id="12字段信息">1.2、字段信息</h2>
<p>字段是指类中定义的静态和实例变量，用类<em>Field</em>表示，位于包<em>java.lang.reflect</em>下，<em>Class</em>有4个获取字段信息的方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 返回所有的public字段，包括其父类的，如果没有字段，返回空数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Field</span><span class="o">[]</span> <span class="nf">getFields</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回本类声明的所有字段，包括非public的，但不包括父类的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Field</span><span class="o">[]</span> <span class="nf">getDeclaredFields</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回本类或父类中指定名称的public字段，找不到抛出异常NoSuchFieldException
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Field</span> <span class="nf">getField</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回本类中声明的指定名称的字段，找不到抛出异常NoSuchFieldException
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Field</span> <span class="nf">getDeclaredField</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Field</em>有很多方法，可以获取字段的信息，也可以访问和 操作指定对象中该字段的值，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 获取字段的名称
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 判断当前程序是否有该字段的访问权限
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isAccessible</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// flag设为true表示忽略Java的访问检查机制，以允许读写非public的字段
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAccessible</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">flag</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 获取指定对象obj中该字段的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Object</span> <span class="nf">get</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 将指定对象obj中该字段的值设为value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>在<em>get/set</em>方法中，对于静态变量，<em>obj</em>被忽略，可以为<em>null</em>，如果字段值为基本类型，<em>get/set</em>会自动在基本类型与对应的包装类型间进行转换；对于<em>private</em>字段，直接调用<em>get/set</em>会抛出非法访问异常<em>IllegalAccessException</em>，应该先调用<em>setAccessible(true)<em>以关闭</em>Java</em>的检查机制。</p>
<p>举个例子，反射修改<em>childDouble</em>、<em>childInt</em>的值，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Child</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kt">double</span> <span class="n">childDouble</span> <span class="o">=</span> <span class="mf">0d</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="kt">int</span> <span class="n">childInt</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Child</span> <span class="n">child</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Child</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Child</span><span class="o">&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">child</span><span class="o">.</span><span class="na">getClass</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="n">Field</span> <span class="n">doubleField</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">&#34;childDouble&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(!</span><span class="n">doubleField</span><span class="o">.</span><span class="na">canAccess</span><span class="o">(</span><span class="n">child</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">doubleField</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">doubleField</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="n">child</span><span class="o">,</span> <span class="mi">88</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">doubleField</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">child</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Field</span> <span class="n">intField</span> <span class="o">=</span> <span class="n">Child</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">&#34;childInt&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span> <span class="o">(!</span><span class="n">intField</span><span class="o">.</span><span class="na">canAccess</span><span class="o">(</span><span class="kc">null</span><span class="o">))</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">intField</span><span class="o">.</span><span class="na">setAccessible</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="n">intField</span><span class="o">.</span><span class="na">set</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="mi">99</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">intField</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="kc">null</span><span class="o">));</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span><span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchFieldException</span> <span class="o">|</span> <span class="n">IllegalAccessException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>除了以上方法，<em>Field</em>还有很多其它方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 返回字段的修饰符
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">int</span> <span class="nf">getModifiers</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回字段的类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">getType</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 以基本类型操作字段
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setBoolean</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">z</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">getBoolean</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setDouble</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="kt">double</span> <span class="n">d</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">double</span> <span class="nf">getDouble</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 查询字段的注解信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="o">&lt;</span><span class="n">T</span> <span class="kd">extends</span> <span class="n">Annotation</span><span class="o">&gt;</span> <span class="n">T</span> <span class="nf">getAnnotation</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="n">annotationClass</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Annotation</span><span class="o">[]</span> <span class="nf">getDeclaredAnnotations</span><span class="o">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="13方法信息">1.3、方法信息</h2>
<p>方法是指类中定义的静态和实例方法，用类<em>Method</em>表示，<em>Class</em>有提供相关方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 返回所有的public方法，包括其父类的，如果没有方法，返回空数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Method</span><span class="o">[]</span> <span class="nf">getMethods</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回本类声明的所有方法，包括非public的，但不包括父类的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Method</span><span class="o">[]</span> <span class="nf">getDeclaredMethods</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回本类或父类中指定名称和参数类型的public方法，
</span></span></span><span class="line"><span class="cl"><span class="c1">// 找不到抛出异常NoSuchMethodException
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Method</span> <span class="nf">getMethod</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;?&gt;...</span> <span class="n">parameterTypes</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回本类中声明的指定名称和参数类型的方法，找不到抛出异常NoSuchMethodException
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Method</span> <span class="nf">getDeclaredMethod</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">Class</span><span class="o">&lt;?&gt;...</span> <span class="n">parameterTypes</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>通过<em>Method</em>可以获取方法的信息，也可以调用对象的方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 获取方法的名称
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// flag设为true表示忽略Java的访问检查机制，以允许调用非public的方法
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAccessible</span><span class="o">(</span><span class="kt">boolean</span> <span class="n">flag</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 在指定对象obj上调用Method代表的方法，传递的参数列表为args
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Object</span> <span class="nf">invoke</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">,</span> <span class="n">Object</span><span class="o">...</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">IllegalAccessException</span><span class="o">,</span> <span class="n">Illegal</span><span class="o">-</span><span class="n">ArgumentException</span><span class="o">,</span> <span class="n">InvocationTargetException</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>对<em>invoke</em>方法，如果<em>Method</em>为静态方法，<em>obj</em>被忽略，可以为<em>null</em>, <em>args</em>可以为<em>null</em>，也可以为一个空的数组，方法调用的返回值被包装为<em>Object</em>返回，如果实际方法调用抛出异常，异常被包装为<em>InvocationTargetException</em>重新抛出，可以通过<em>getCause</em>方法得到原异常。</p>
<p>举个例子，反射调用<em>Integer</em>的<em>parseInt</em>方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">Integer</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Method</span> <span class="n">method</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="na">getMethod</span><span class="o">(</span><span class="s">&#34;parseInt&#34;</span><span class="o">,</span> <span class="k">new</span> <span class="n">Class</span><span class="o">[]{</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">});</span>
</span></span><span class="line"><span class="cl">    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">method</span><span class="o">.</span><span class="na">invoke</span><span class="o">(</span><span class="kc">null</span><span class="o">,</span> <span class="s">&#34;123&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">NoSuchMethodException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InvocationTargetException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="14创建对象和构造方法">1.4、创建对象和构造方法</h2>
<p><em>Class</em>还有一些方法，可以获取所有的构造方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 获取所有的public构造方法，返回值可能为长度为0的空数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Constructor</span><span class="o">&lt;?&gt;[]</span> <span class="n">getConstructors</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 获取所有的构造方法，包括非public的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Constructor</span><span class="o">&lt;?&gt;[]</span> <span class="n">getDeclaredConstructors</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 获取指定参数类型的public构造方法，没找到抛出异常NoSuchMethodException
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Constructor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">getConstructor</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;...</span> <span class="n">parameterTypes</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 获取指定参数类型的构造方法，包括非public的，没找到抛出异常NoSuchMethodException
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Constructor</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span> <span class="nf">getDeclaredConstructor</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;...</span> <span class="n">parameterTypes</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>类<em>Constructor</em>表示构造方法，通过它可以创建对象，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">T</span> <span class="nf">newInstance</span><span class="o">(</span><span class="n">Object</span> <span class="o">...</span> <span class="n">initargs</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InstantiationException</span><span class="o">,</span><span class="n">IllegalAccessException</span><span class="o">,</span> <span class="n">IllegalArgumentException</span><span class="o">,</span> <span class="n">InvocationTargetException</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>举个例子，反射创建<em>StringBuilder</em>对象，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Constructor</span><span class="o">&lt;</span><span class="n">StringBuilder</span><span class="o">&gt;</span> <span class="n">contructor</span><span class="o">=</span> <span class="n">StringBuilder</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">getConstructor</span><span class="o">(</span><span class="k">new</span> <span class="n">Class</span><span class="o">[]{</span><span class="kt">int</span><span class="o">.</span><span class="na">class</span><span class="o">});</span>
</span></span><span class="line"><span class="cl"><span class="n">StringBuilder</span> <span class="n">sb</span> <span class="o">=</span> <span class="n">contructor</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="mi">100</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="15类型检查和转换">1.5、类型检查和转换</h2>
<p><em>Class</em>类提供了相关方法来判断变量指向的实际对象类型，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">native</span> <span class="kt">boolean</span> <span class="nf">isInstance</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>举个例子，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">ArrayList</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isInstance</span><span class="o">(</span><span class="n">list</span><span class="o">));</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>除了判断类型，在程序中也往往需要进行强制类型转换，<em>Class</em>类也提供了相关方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">T</span> <span class="nf">cast</span><span class="o">(</span><span class="n">Object</span> <span class="n">obj</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>isInstance/cast</em>描述的都是对象和类之间的关系，<em>Class</em>还有一个方法，可以判断<em>Class</em>之间的关系，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 检查参数类型cls能否赋给当前Class类型的变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">native</span> <span class="kt">boolean</span> <span class="nf">isAssignableFrom</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>举个例子，如下表达式的结果都为<em>true</em>，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Object</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="n">List</span><span class="o">.</span><span class="na">class</span><span class="o">.</span><span class="na">isAssignableFrom</span><span class="o">(</span><span class="n">ArrayList</span><span class="o">.</span><span class="na">class</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="16class的类型信息">1.6、<em>Class</em>的类型信息</h2>
<p><em>Class</em>类提供了相关方法来判断给定的<em>Class</em>对象是什么类型，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">native</span> <span class="kt">boolean</span> <span class="nf">isArray</span><span class="o">()</span>  <span class="c1">//是否是数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">native</span> <span class="kt">boolean</span> <span class="nf">isPrimitive</span><span class="o">()</span>  <span class="c1">//是否是基本类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">native</span> <span class="kt">boolean</span> <span class="nf">isInterface</span><span class="o">()</span>  <span class="c1">//是否是接口
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isEnum</span><span class="o">()</span>  <span class="c1">//是否是枚举
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isAnnotation</span><span class="o">()</span>  <span class="c1">//是否是注解
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isAnonymousClass</span><span class="o">()</span>  <span class="c1">//是否是匿名内部类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isMemberClass</span><span class="o">()</span>  <span class="c1">//是否是成员类，成员类定义在方法外，不是匿名类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isLocalClass</span><span class="o">()</span>  <span class="c1">//是否是本地类，本地类定义在方法内，不是匿名类
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="17类的声明信息">1.7、类的声明信息</h2>
<p><em>Class</em>类提供了相关方法来获取类的声明信息，如修饰符、父类、接口、注解等等，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 获取修饰符，返回值可通过Modifier类进行解读
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">native</span> <span class="kt">int</span> <span class="nf">getModifiers</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 获取父类，如果为Object，父类为null
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">native</span> <span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">super</span> <span class="n">T</span><span class="o">&gt;</span> <span class="nf">getSuperclass</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 对于类，为自己声明实现的所有接口，对于接口，为直接扩展的接口，不包括通过父类继承的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">native</span> <span class="n">Class</span><span class="o">&lt;?&gt;[]</span> <span class="n">getInterfaces</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 自己声明的注解
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Annotation</span><span class="o">[]</span> <span class="nf">getDeclaredAnnotations</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 所有的注解，包括继承得到的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">Annotation</span><span class="o">[]</span> <span class="nf">getAnnotations</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 获取或检查指定类型的注解，包括继承得到的
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="o">&lt;</span><span class="n">A</span> <span class="kd">extends</span> <span class="n">Annotation</span><span class="o">&gt;</span> <span class="n">A</span> <span class="nf">getAnnotation</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">A</span><span class="o">&gt;</span> <span class="n">annotationClass</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">boolean</span> <span class="nf">isAnnotationPresent</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Annotation</span><span class="o">&gt;</span> <span class="n">annotationClass</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="18类的加载">1.8、类的加载</h2>
<p><em>Class</em>有两个静态方法，可以根据类名加载类，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">forName</span><span class="o">(</span><span class="n">String</span> <span class="n">className</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">forName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="kt">boolean</span> <span class="n">initialize</span><span class="o">,</span> <span class="n">ClassLoader</span> <span class="n">loader</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>ClassLoader</em>表示类加载器，<em>initialize</em>表示加载后，是否执行类的初始化代码（如<em>static</em>语句块）。</p>
<p>需要注意的是，基本类型不支持<em>forName</em>方法，会抛出异常<em>ClassNotFoundException</em>，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="s">&#34;int&#34;</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>可以对<em>Class.forName</em>进行一下包装，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">forName</span><span class="o">(</span><span class="n">String</span> <span class="n">className</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">        <span class="kd">throws</span> <span class="n">ClassNotFoundException</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="k">if</span><span class="o">(</span><span class="s">&#34;int&#34;</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="n">className</span><span class="o">)){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="kt">int</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 其它基本类型略
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="k">return</span> <span class="n">Class</span><span class="o">.</span><span class="na">forName</span><span class="o">(</span><span class="n">className</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="19反射与数组">1.9、反射与数组</h2>
<p>对于数组类型，有一个专门的方法，可以获取它的元素类型，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">native</span> <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">getComponentType</span><span class="o">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>举个例子，获取 <em>String[]</em> 的元素类型，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">String</span><span class="o">[]</span> <span class="n">arr</span> <span class="o">=</span> <span class="k">new</span> <span class="n">String</span><span class="o">[]{};</span>
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">arr</span><span class="o">.</span><span class="na">getClass</span><span class="o">().</span><span class="na">getComponentType</span><span class="o">());</span> <span class="c1">// class java.lang.String
</span></span></span></code></pre></td></tr></table>
</div>
</div><p><em>java.lang.reflect</em>包中有一个针对数组的专门的类<em>Array</em>，提供了对于数组的一些反射支持，以便于统一处理多种类型的数组，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// 创建指定元素类型、指定长度的数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="n">Object</span> <span class="nf">newInstance</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">componentType</span><span class="o">,</span> <span class="kt">int</span> <span class="n">length</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 创建多维数组
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="n">Object</span> <span class="nf">newInstance</span><span class="o">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">componentType</span><span class="o">,</span> <span class="kt">int</span><span class="o">...</span> <span class="n">dimensions</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 获取数组array指定的索引位置index处的值
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kd">native</span> <span class="n">Object</span> <span class="nf">get</span><span class="o">(</span><span class="n">Object</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 修改数组array指定的索引位置index处的值为value
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kd">native</span> <span class="kt">void</span> <span class="nf">set</span><span class="o">(</span><span class="n">Object</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">,</span> <span class="n">Object</span> <span class="n">value</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="c1">// 返回数组的长度
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kd">native</span> <span class="kt">int</span> <span class="nf">getLength</span><span class="o">(</span><span class="n">Object</span> <span class="n">array</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>需要注意的是，在<em>Array</em>类中，数组是用<em>Object</em>而非 <em>Object[]</em> 表示的，这是为了方便处理多种类型的数组，<em>int[]</em>、<em>String[]<em>都不能与</em>Object[]<em>相互转换，但可以与</em>Object</em>相互转换，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kt">int</span><span class="o">[]</span> <span class="n">intArr</span> <span class="o">=</span> <span class="o">(</span><span class="kt">int</span><span class="o">[])</span><span class="n">Array</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="kt">int</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">String</span><span class="o">[]</span> <span class="n">strArr</span> <span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">[])</span><span class="n">Array</span><span class="o">.</span><span class="na">newInstance</span><span class="o">(</span><span class="n">String</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="mi">10</span><span class="o">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>除了以<em>Object</em>类型操作数组元素外，<em>Array</em>也支持以各种基本类型操作数组元素，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kd">native</span> <span class="kt">double</span> <span class="nf">getDouble</span><span class="o">(</span><span class="n">Object</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kd">native</span> <span class="kt">void</span> <span class="nf">setDouble</span><span class="o">(</span><span class="n">Object</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">,</span> <span class="kt">double</span> <span class="n">d</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kd">native</span> <span class="kt">void</span> <span class="nf">setLong</span><span class="o">(</span><span class="n">Object</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">,</span> <span class="kt">long</span> <span class="n">l</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kd">native</span> <span class="kt">long</span> <span class="nf">getLong</span><span class="o">(</span><span class="n">Object</span> <span class="n">array</span><span class="o">,</span> <span class="kt">int</span> <span class="n">index</span><span class="o">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="110反射与枚举">1.10、反射与枚举</h2>
<p>枚举类型也有一个专门方法，可以获取所有的枚举常量，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">T</span><span class="o">[]</span> <span class="nf">getEnumConstants</span><span class="o">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="二反射与泛型">二、反射与泛型</h1>
<p>虽然泛型参数在运行时会被擦除，但是在类信息<em>Class</em>中依然有关于泛型的一些信息，可以通过反射得到。<em>Class</em>类提供了相关方法来获取类的泛型参数信息，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">// TypeVariable对象的数组，表示此泛型声明所声明的类型变量
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="n">TypeVariable</span><span class="o">&lt;</span><span class="n">Class</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;&gt;[]</span> <span class="nf">getTypeParameters</span><span class="o">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Field</em>类也提供了相关方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Type</span> <span class="nf">getGenericType</span><span class="o">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Method</em>类也提供了相关方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Type</span> <span class="nf">getGenericReturnType</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Type</span><span class="o">[]</span> <span class="nf">getGenericParameterTypes</span><span class="o">()</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Type</span><span class="o">[]</span> <span class="nf">getGenericExceptionTypes</span><span class="o">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Constructor</em>类也提供了相关方法，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Type</span><span class="o">[]</span> <span class="nf">getGenericParameterTypes</span><span class="o">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><em>Type</em>是一个接口，<em>Class</em>实现了<em>Type</em>，<em>Type</em>的其它子接口还有：</p>
<p>1、<em>TypeVariable</em>：类型参数，可以有上界，比如<em>T extends Number</em></p>
<p>2、<em>ParameterizedType</em>：参数化的类型，有原始类型和具体的类型参数，比如<em>List<String></em></p>
<p>3、<em>WildcardType</em>：通配符类型，比如?、<em>? extends Number</em>、<em>? super Integer</em></p>
<p>举个例子，请看如下代码：</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GenericDemo</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="kd">class</span> <span class="nc">GenericTest</span><span class="o">&lt;</span><span class="n">U</span> <span class="kd">extends</span> <span class="n">Comparable</span><span class="o">&lt;</span><span class="n">U</span><span class="o">&gt;,</span> <span class="n">V</span><span class="o">&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">U</span> <span class="n">u</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">V</span> <span class="n">v</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">list</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="n">U</span> <span class="nf">test</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;?</span> <span class="kd">extends</span> <span class="n">Number</span><span class="o">&gt;</span> <span class="n">numbers</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">return</span> <span class="kc">null</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Class</span><span class="o">&lt;?&gt;</span> <span class="n">cls</span> <span class="o">=</span> <span class="n">GenericTest</span><span class="o">.</span><span class="na">class</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 类的类型参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">for</span><span class="o">(</span><span class="n">TypeVariable</span> <span class="n">t</span> <span class="o">:</span> <span class="n">cls</span><span class="o">.</span><span class="na">getTypeParameters</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34; extends &#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">                <span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">t</span><span class="o">.</span><span class="na">getBounds</span><span class="o">()));</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 字段：泛型类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Field</span> <span class="n">fu</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">&#34;u&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">fu</span><span class="o">.</span><span class="na">getGenericType</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 字段：参数化的类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Field</span> <span class="n">flist</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="na">getDeclaredField</span><span class="o">(</span><span class="s">&#34;list&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Type</span> <span class="n">listType</span> <span class="o">=</span> <span class="n">flist</span><span class="o">.</span><span class="na">getGenericType</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span><span class="o">(</span><span class="n">listType</span> <span class="k">instanceof</span> <span class="n">ParameterizedType</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">ParameterizedType</span> <span class="n">pType</span> <span class="o">=</span> <span class="o">(</span><span class="n">ParameterizedType</span><span class="o">)</span> <span class="n">listType</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;raw type: &#34;</span> <span class="o">+</span> <span class="n">pType</span><span class="o">.</span><span class="na">getRawType</span><span class="o">()</span>
</span></span><span class="line"><span class="cl">                <span class="o">+</span> <span class="s">&#34;,type arguments:&#34;</span>
</span></span><span class="line"><span class="cl">                <span class="o">+</span> <span class="n">Arrays</span><span class="o">.</span><span class="na">toString</span><span class="o">(</span><span class="n">pType</span><span class="o">.</span><span class="na">getActualTypeArguments</span><span class="o">()));</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 方法的泛型参数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Method</span> <span class="n">m</span> <span class="o">=</span> <span class="n">cls</span><span class="o">.</span><span class="na">getMethod</span><span class="o">(</span><span class="s">&#34;test&#34;</span><span class="o">,</span> <span class="k">new</span> <span class="n">Class</span><span class="o">[]</span> <span class="o">{</span> <span class="n">List</span><span class="o">.</span><span class="na">class</span> <span class="o">});</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span><span class="o">(</span><span class="n">Type</span> <span class="n">t</span> <span class="o">:</span> <span class="n">m</span><span class="o">.</span><span class="na">getGenericParameterTypes</span><span class="o">())</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">t</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>程序输出如下。</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">U extends [java.lang.Comparable&lt;U&gt;]
</span></span><span class="line"><span class="cl">V extends [class java.lang.Object]
</span></span><span class="line"><span class="cl">U
</span></span><span class="line"><span class="cl">raw type: interface java.util.List,type arguments:[class java.lang.String]
</span></span><span class="line"><span class="cl">java.util.List&lt;? extends java.lang.Number&gt;
</span></span></code></pre></td></tr></table>
</div>
</div><p>反射虽然是灵活的，但一般情况下，并不是我们优先建议的，主要原因是：</p>
<p>1、反射更容易出现运行时错误，因为类型是运行时才知道的，编译器无能为力。</p>
<p>2、反射的性能要低一些，在访问字段、调用方法前，反射先要查找对应的<em>Field/Method</em>，要慢一些。</p>
<p>简而言之，如果能用接口实现同样的灵活性，就不要使用反射。</p>

    </div>

    <div class="post-copyright">
  <p class="copyright-item">
    <span class="item-title">文章作者</span>
    <span class="item-content">AndDevMK</span>
  </p>
  <p class="copyright-item">
    <span class="item-title">上次更新</span>
    <span class="item-content">
        2023-12-20
        
    </span>
  </p>
  
  <p class="copyright-item">
    <span class="item-title">许可协议</span>
    <span class="item-content"><a rel="license noopener" href="https://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">CC BY-NC-ND 4.0</a></span>
  </p>
</div>
<div class="post-reward">
  <input type="checkbox" name="reward" id="reward" hidden />
  <label class="reward-button" for="reward">赞赏支持</label>
  <div class="qr-code">
    
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/wechat-qr-code.JPG">
        <span>微信打赏</span>
      </label>
    <label class="qr-code-image" for="reward">
        <img class="image" src="/img/reward/alipay-qr-code.JPG">
        <span>支付宝打赏</span>
      </label>
  </div>
</div><footer class="post-footer">
      
      <nav class="post-nav">
        
        <a class="next" href="/post/java%E5%BF%85%E5%A4%87%E5%9F%BA%E7%A1%80%E4%B9%8B%E6%B3%A8%E8%A7%A3/">
            <span class="next-text nav-default">Java必备基础之注解</span>
            <span class="next-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        

  

  
    <script src="https://utteranc.es/client.js"
            repo="AndDevMK/blog-utterances"
            issue-term="pathname"
            theme="github-light"
            crossorigin="anonymous"
            async>
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://github.com/utterance">comments powered by utterances.</a></noscript>

      </div>
    </main>

    
    <div id="search_mask" class="search_mask">
    <div class="search_modal">
        <div id="close_search" class="close_search">关闭</div>
        <div class="search_divider"></div>
        <input id="input_search_key" class="input_search_key" placeholder="请输入你要搜索的内容" tabindex="0">
        <ul id="search_list">
        </ul>
    </div>
</div>

<script src="/js/fuse.js"></script> 
<script src="/js/fastsearch.js"></script>

    <footer id="footer" class="footer">
      

<div class="copyright">
  <span class="power-by">
    由 <a id="hexo-link" class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  

  <span class="copyright-year">
    
    <span id="run-time" class="run-time"></span> 
    <span class="heart"><i class="iconfont icon-heart"></i></span>
    &copy; 
    2023 - 
    2024&nbsp;
    <span>AndDevMK</span>
  </span>
</div>

    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  <script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>



<script type="text/javascript" src="/js/main.min.11a4ba15caf2d921d57eaf6568c4ad21eafd5d2c001cbcb31693586c63f93005.js"></script>

<script id="baidu_analytics">
  var _hmt = _hmt || [];
  (function() {
    if (window.location.hostname === 'localhost') return;
    var hm = document.createElement("script"); hm.async = true;
    hm.src = "https://hm.baidu.com/hm.js?6db179fb88e600cf326b0515a8aa1de3";
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(hm, s);
  })();
</script>




<script src="/js/codecopy.js"></script>



<link disabled id="dark-mode-theme" rel="stylesheet" href="/css/dark.css"></link>
<script src="/js/dark.js"></script>


<script src="/js/site_runtime.js"></script>




</body>
</html>
